{% extends "admin/change_form.html" %}
{% load i18n admin_urls static %}

{% block field_sets %}
<style>
    /* حذف ستون سوم و تمام عرض برای محتوا */
    #content-main {
        width: 100% !important;
        max-width: 100% !important;
    }
    
    .submit-row,
    #jazzy-actions {
        display: none !important;
    }
    
    .form-row {
        width: 100% !important;
        max-width: 100% !important;
    }
    
    .col-12.col-lg-9 {
        flex: 0 0 100% !important;
        max-width: 100% !important;
    }
    
    .col-12.col-lg-3 {
        display: none !important;
    }
</style>

{% if original %}
    {# نمایش اطلاعات تیکت #}
    <div style="margin-bottom: 20px; width: 100%;">
        {% for fieldset in adminform %}
            {% for line in fieldset %}
                {% for field in line %}
                    {% if field.field.name == 'ticket_info_display' %}
                        {{ field.field }}
                    {% endif %}
                {% endfor %}
            {% endfor %}
        {% endfor %}
    </div>
    
    {# نمایش تاریخچه مکالمات #}
    <div style="margin-bottom: 20px; width: 100%;">
        {% for fieldset in adminform %}
            {% for line in fieldset %}
                {% for field in line %}
                    {% if field.field.name == 'messages_display' %}
                        {{ field.field }}
                    {% endif %}
                {% endfor %}
            {% endfor %}
        {% endfor %}
    </div>
    
    {# فرم پاسخ جدید #}
    <div style="margin-bottom: 20px; width: 100%;">
        {% for fieldset in adminform %}
            {% for line in fieldset %}
                {% for field in line %}
                    {% if field.field.name == 'reply_form_display' %}
                        {{ field.field }}
                    {% endif %}
                {% endfor %}
            {% endfor %}
        {% endfor %}
    </div>
        
        <script>
        function toggleForwardedTo(messageType) {
            var field = document.getElementById('forwarded_to_field');
            if (messageType === 'send_to') {
                field.style.display = 'block';
            } else {
                field.style.display = 'none';
            }
        }
        
        // اجرای اولیه
        document.addEventListener('DOMContentLoaded', function() {
            var selectedType = document.querySelector('input[name="message_type"]:checked');
            if (selectedType) {
                toggleForwardedTo(selectedType.value);
            }
        });
        </script>
{% else %}
    {# فرم ایجاد تیکت جدید غیرفعال است #}
    <div style="padding: 40px; text-align: center;">
        <p style="font-size: 18px; color: #6b7280;">ایجاد تیکت از پنل ادمین غیرفعال است.</p>
    </div>
{% endif %}
{% endblock %}
